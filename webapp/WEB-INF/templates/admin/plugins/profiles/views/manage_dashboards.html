<#macro dashboardTable items=[] list_available_orders_column=[] order=true unsetColumn=true>
	<#if items?exists && items?size &gt; 0>
		<table class="table table-striped table-condensed">
			<tr> <#-- header -->
				<th>#i18n{portal.dashboard.table.title.name}</th> <#-- name -->
				<th>#i18n{portal.dashboard.table.title.column}</th> <#-- column -->
				<#if order><th>#i18n{portal.dashboard.table.title.order}</th></#if> <#-- order -->
				<#if unsetColumn><th>#i18n{profiles.manage_dashboards.table.title.actions}</th></#if> <#-- unsetColumn -->
			</tr>
			<#list items as dashboard>
				<tr>
					<td>${dashboard.name}</td> <#-- name -->
					<td> <#-- column -->
						<form class="form" action="jsp/admin/plugins/profiles/DoMoveDashboard.jsp" method="post">
						<input type="hidden" name="dashboard_name" value="${dashboard.name}"/>
						<#if !dashboard.order?exists || dashboard.order == 0 >
							<#assign dashboard_order=1/>
						<#else>
							<#assign dashboard_order=dashboard.order/>
						</#if>
						<input type="hidden" name="dashboard_order" value="${dashboard_order}"/>
						<input type="hidden" name="view_key" value="${view.key}"/>
							<@comboSortedWithParams name="dashboard_column" default_value="${dashboard.zone!}" additionalParameters="class=\"span4\"" items=list_available_columns />
							<button class="btn btn-primary btn-small" type="submit" title="#i18n{portal.dashboard.table.action.setColumn}" >
								<i class="icon-ok icon-white"></i>
							</button>
						</form>
					</td> <#-- /column -->
					<#if order>
					<td> <#-- order -->
						<form class="form" action="jsp/admin/plugins/profiles/DoMoveDashboard.jsp" method="post">
						<input type="hidden" name="dashboard_name" value="${dashboard.name}"/>
						<#if !dashboard.zone?exists  || dashboard.zone == 0>
							<#assign dashboard_column=1 />
						<#else>
							<#assign dashboard_column=dashboard.zone />
						</#if>
						<input type="hidden" name="dashboard_column" value="${dashboard_column}"/>
						<input type="hidden" name="view_key" value="${view.key}"/>
						<@comboSortedWithParams name="dashboard_order" default_value="${dashboard.order!}" additionalParameters="class=\"span4\"" items=list_available_orders_column />
						<button class="btn btn-primary btn-small" type="submit" title="#i18n{portal.dashboard.table.action.move}" >
							<i class="icon-move icon-white"></i>
						</button>
					</form>
					</td> <#-- /order -->
					</#if>
					<#if unsetColumn>
					<td> <#-- unsetColumn -->
						<form class="form" action="jsp/admin/plugins/profiles/DoUnsetColumn.jsp" method="post">
						<input type="hidden" name="dashboard_name" value="${dashboard.name}"/>
						<input type="hidden" name="view_key" value="${view.key}"/>
						<button class="btn btn-danger btn-small" type="submit" title="#i18n{profiles.manage_dashboards.action.unsetColumn}">
							<i class="icon-trash icon-white"></i>
						</button>
						</form>
					</td> <#-- /unsetColumn -->
					</#if>
				</tr>
			</#list>
		</table>
	<#else>
		<p>	#i18n{portal.dashboard.message.emptyGroup}</p>
	</#if>
</#macro>
<div class="row-fluid">
	<div class="span3">
        <fieldset>
    	<legend>#i18n{profiles.manage_views.columnKey} : ${view.key}</legend>
    	<p><strong> #i18n{profiles.manage_views.columnDescription}</strong></p>
		<p> ${view.description}</p>
        <p><strong>#i18n{profiles.manage_views.columnActions}</strong></p>
		<p>
			<@item_navigation item_navigator=item_navigator />
				<#if view.actions?exists>
					<#list view.actions as action>
						<a class="btn <#if action.permission!='DELETE_VIEW'>btn-primary<#else>btn-danger</#if> btn-small" href="${action.url}?view_key=${view.key}"  title="${action.description}" >
							<i class="${action.iconUrl} icon-white"></i>
						</a>
					</#list>
				</#if>
        </p>
		</fieldset>
    </div>
	<div class="span9">
		 <fieldset>
		<legend>#i18n{portal.dashboard.title.manage}</legend>
		<#-- column lists -->
		<#list list_available_columns as column_refItem>
			<#if column_refItem.code != ''>
				<#assign column_key = column_refItem.code />
				<p class="lead">#i18n{portal.dashboard.title.column} ${column_key}</p>
				<#if map_column_order_status[column_key]?exists && !map_column_order_status[column_key]>
				<p>
					<a class="alert" href="jsp/admin/plugins/profiles/DoReorderColumn.jsp?column=${column_key}&amp;view_key=${view.key}">#i18n{portal.dashboard.action.reorder}</a>
				</p>
				</#if>
				<@dashboardTable items=map_dashboards[column_key] list_available_orders_column=map_available_orders[column_key] />
				<#-- suggest reorder if the column is not well ordered -->
			</#if>
		</#list>
		<#-- not set list -->
		<p class="lead">#i18n{portal.dashboard.title.notSetDashboard}</p>
		<@dashboardTable items=not_set_dashboards order=false unsetColumn=false/>
		</fieldset>
	</div>
</div>